:root{
  /* Dark theme with WCAG AAA compliant colors (7:1 contrast ratio) */
  --bg:#0a0f1e;
  --bg2:#0d1429;
  --panel:#0f172a;
  --panelSoft:#111a34;
  --text:#f0f3f9; /* Increased from #e5e7eb for better contrast */
  --muted:#a8b4d1; /* Increased from #96a2c7 for better contrast */
  --accent:#7dd3fc;
  --accent2:#b4a3ff; /* Lightened from #a78bfa for better contrast */
  --ok:#12d98f; /* Lightened from #10b981 for better contrast */
  --warn:#ffb627; /* Lightened from #f59e0b for better contrast */
  --bad:#ff6b6b; /* Lightened from #ef4444 for better contrast */
  --border:#2d3f5f; /* Lightened from #23304d for better visibility */
  --shadow:rgba(0,0,0,.35);
  --focus-ring:#60a5fa; /* Blue focus ring for accessibility */

  /* Layout */
  --card-pad: 14px;
  --gap: 16px;
  --cell-h: 40px;
  --border-radius: 12px;
  --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Light theme support */
:root.light {
  --bg:#f8fafc;
  --bg2:#f1f5f9;
  --panel:#ffffff;
  --panelSoft:#fefefe;
  --text:#0f172a;
  --muted:#475569;
  --accent:#0284c7;
  --accent2:#7c3aed;
  --ok:#059669;
  --warn:#d97706;
  --bad:#dc2626;
  --border:#cbd5e1;
  --shadow:rgba(0,0,0,.08);
  --focus-ring:#3b82f6;
}

/* Reset & base */
*{
  box-sizing:border-box;
  margin:0;
  padding:0;
}

/* Smooth scrolling */
html{
  scroll-behavior: smooth;
  height:100%;
}

body{
  min-height:100%;
  margin:0;
  background:
    radial-gradient(1200px 600px at 20% 0%, #0b1226 0%, #090f1c 35%, #080d18 100%),
    var(--bg);
  color:var(--text);
  font: 18px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Focus styles for accessibility */
*:focus{
  outline: 2px solid var(--focus-ring);
  outline-offset: 2px;
}

*:focus:not(:focus-visible){
  outline: none;
}

*:focus-visible{
  outline: 2px solid var(--focus-ring);
  outline-offset: 2px;
}

/* Reduced motion for accessibility */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Layout */
.container{ max-width: 1200px; margin: 0 auto; padding: 16px; }

.header{
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; padding-bottom:8px;
}
.header-actions{ display:flex; flex-wrap:wrap; align-items:center; gap:8px;  }

/* Cards */
.card{
  background: linear-gradient(180deg, var(--panel) 0%, var(--panelSoft) 100%);
  border:1px solid var(--border);
  border-radius: var(--border-radius);
  box-shadow: 0 10px 30px var(--shadow), 0 4px 6px rgba(0,0,0,.1);
  padding: var(--card-pad);
  transition: var(--transition);
}

.card:hover{
  box-shadow: 0 12px 35px var(--shadow), 0 6px 10px rgba(0,0,0,.15);
  transform: translateY(-2px);
}

/* Make pre-sections comfortably spaced from sections below */
.pre-sections{ max-width: 1200px; margin: 0 auto 18px; padding: 0 12px; width:100%; }
.summary-grid{
  margin-top: 15px;
  display:grid; grid-template-columns: repeat(auto-fit, minmax(260px,1fr));
  gap: var(--gap);
}
.chart-card{ margin-top: 8px; height: 340px; padding-bottom: 7.5vh;}

/* Simple grid helpers (no Tailwind dependency) */
.mt-3 { margin-top: 15px; }
.grid{ display:grid; gap: var(--gap); }
.md\:grid-cols-3{ grid-template-columns: repeat(1,minmax(0,1fr)); }
@media (min-width: 768px){ .md\:grid-cols-3{ grid-template-columns: repeat(3,minmax(0,1fr)); } }
.xl\:grid-cols-2{ grid-template-columns: repeat(1,minmax(0,1fr)); }
@media (min-width: 1200px){ .xl\:grid-cols-2{ grid-template-columns: repeat(2,minmax(0,1fr)); } }

/* Space the section grid away from surrounding content */
.grid.xl\:grid-cols-2{ margin-top: 15px; margin-bottom: 15px; padding: 15px; }

/* Tabs */
.tabs-grid{
  display:grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr));
  gap: var(--gap); margin-top: 15px;
}

/* Spacing helpers */
.opacity-80{margin: 15px;}

/* Typography */
.text-lg, .text-xs{
  font-size: 20px; line-height: 1.4; font-weight: 600;
}
.text-lg{ margin-bottom: 10px; }
.text-sm{
  font-size: 18px; line-height: 1.4; font-weight: 500;
}

/* Buttons with improved accessibility */
.btn{
  background: transparent;
  color: var(--text);
  border:1px solid var(--border);
  padding: 8px 14px;
  border-radius: 10px;
  margin-bottom: 5px;
  cursor:pointer;
  transition: var(--transition);
  height: var(--cell-h);
  font-size: 16px;
  font-weight: 500;
  position: relative;
  overflow: hidden;
}

.btn::before{
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255,255,255,.1);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}

.btn:hover::before{
  width: 300px;
  height: 300px;
}

.justify-end{margin-top: 15px;}
.btn:hover{
  background:#1a2d4d;
  border-color: var(--accent);
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(0,0,0,.2);
}

.btn-primary{
  background: linear-gradient(135deg,#5563d1 0%,#4451bf 100%);
  border-color:#4856c7;
  color:#ffffff;
  font-weight: 600;
}
.btn-primary:hover{
  filter: brightness(1.12);
  box-shadow: 0 6px 12px rgba(69,81,191,.4);
}

.btn-danger{
  background:#4a1515;
  border-color:#732424;
  color:#ffc9c9;
}
.btn-danger:hover{
  background:#5f1d1d;
  border-color:#8f2f2f;
}

.btn-ghost{
  background: linear-gradient(135deg,#c85555 0%,#b03f3f 100%);
  border-color:#c04848;
  color:#ffffff;
}
.btn-ghost:hover{
  filter: brightness(1.12);
}

.btn:disabled{
  opacity:.5;
  cursor:not-allowed;
  transform: none;
}

.btn:active{
  transform: translateY(0);
}

/* Button focus states */
.btn:focus-visible{
  outline: 3px solid var(--focus-ring);
  outline-offset: 2px;
}

/* Section header bar */
.section-head{
  display:flex; align-items:center; justify-content:space-between;
  padding:12px var(--card-pad); border-bottom:1px solid var(--border);
}

/* Tables */
.table-wrap{
  overflow:auto;
  background:
    linear-gradient(to right, var(--panel) 30%, rgba(15,23,42,0)),
    linear-gradient(to left,  var(--panel) 30%, rgba(15,23,42,0)) 100% 0/auto auto no-repeat,
    linear-gradient(to right, rgba(0,0,0,.15), rgba(0,0,0,0)),
    linear-gradient(to left,  rgba(0,0,0,.15), rgba(0,0,0,0)) 100% 0/auto auto no-repeat;
  background-attachment: local, local, scroll, scroll;
  border-radius: 0 0 12px 12px;
  padding: 8px;
}
table{ width:100%; border-collapse: separate; border-spacing:0; }

thead th{
  position: sticky; top:0; z-index:2;
  background:var(--panel);
  color:var(--muted); font-weight:600; white-space:nowrap;
  padding: 10px 8px; border-bottom:1px solid var(--border);
}
tbody td{
  border-bottom:1px solid rgba(35,48,77,0.55);
  padding: 4px 6px; vertical-align: top; white-space:nowrap; 
}

/* Sticky first column + better width for names */
.sticky-col{
  position: sticky; left:0; z-index:1;
  background:var(--panel); border-right:1px solid var(--border);
  min-width: 220px; max-width: 260px;
}
.row-name{ display:flex; align-items:center; gap:8px; }
.row-name .name{
  overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}

/* Inputs: readable; but truly empty cells look blank until hover/focus */
input, select{
  width:fit-content;
  height: var(--cell-h);
  background:#0a1226;
  border:1px solid #1e2a47;
  color:var(--text);
  padding: 6px 10px;
  border-radius:8px;
  outline:none;
  font-size: 16px;
  transition: var(--transition);
}

input:hover, select:hover{
  border-color: #2d4068;
  background: #0d1630;
}

input:focus, select:focus{
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(125,211,252,.2);
  background: #0f1833;
}

input[type="number"]{
  text-align:right;
  font-variant-numeric: tabular-nums;
  font-feature-settings: "tnum" 1;
}

/* Ensure inputs are accessible on mobile */
input::placeholder, select::placeholder{
  color: var(--muted);
  opacity: 0.6;
}

/* Remove spinner buttons on number inputs for cleaner look */
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button{
  -webkit-appearance: none;
  margin: 0;
}

input[type="number"]{
  -moz-appearance: textfield;
}

/* “Blank until edit”: any numeric input with empty value renders invisible until hover/focus */
td input.cell-input[value=""]{
  background: transparent; border-color: transparent; color: transparent;
  box-shadow: none;
}
td input.cell-input[value=""]:hover{
  background:#0f1833; border-color:#1e2a47; color:var(--text);
}
td input.cell-input[value=""]:focus{
  background:#0a1226; border-color:#3b82f6; color:var(--text);
}

/* Weekly summary: only Balance & Cumulative cells go red when negative */
td.neg {
  background: rgba(239,68,68,.16);
  color:#fecaca;
  font-weight:600;
}

/* X-axis header cells (dates) a bit larger & spaced */
thead th.date-col{ font-size: 13px; padding: 10px 10px; }

/* Calendar */
.calendar-grid{ display:grid; grid-template-columns: repeat(7,1fr); gap:6px; }
.calendar-day{
  min-height: 70px; border:1px solid var(--border); border-radius:10px;
  padding:6px; display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
  cursor:pointer; background:#0e1730;
}
.calendar-day:hover{ background:#122049; }
.calendar-day--empty{ opacity:.35; cursor:default; }
.calendar-day--selected{ outline: 2px solid #8ab4ff; }
.calendar-badge{ font-size:11px; padding:2px 6px; border-radius:999px; border:1px solid transparent; }
.badge-income{ background:rgba(16,185,129,.18); border-color:rgba(16,185,129,.35); }
.badge-outflow{ background:rgba(239,68,68,.18); border-color:rgba(239,68,68,.35); }

/* Toasts */
.toast-stack{ position:fixed; top:16px; right:16px; z-index:9000; display:flex; flex-direction:column; gap:8px; }
.toast{
  background:#101a36; border:1px solid #23304d; color:var(--text); padding:10px 12px;
  border-radius:10px; box-shadow:0 10px 20px rgba(0,0,0,.3);
}

/* Modal — always above chart; compact contour */
.modal{ position: fixed; inset:0; z-index:10000; display:flex; align-items:center; justify-content:center; }
.modal-overlay{ position:absolute; inset:0; background: rgba(2,8,23,.62); backdrop-filter: blur(2px); }
.modal-card{ position:relative; width:min(380px,92vw);}
.modal .card{ padding: 14px; box-shadow: 0 20px 60px rgba(0,0,0,.6); }

/* Helpers for min-width tables */
.minw-760{ min-width:760px; }
.minw-900{ min-width:900px; }
.minw-1080{ min-width:1080px; }

/* Responsive tweaks - Mobile-first approach */

/* Extra small devices (phones, less than 576px) */
@media (max-width: 575px){
  body{ font-size: 16px; }
  .container{ padding: 12px; }
  .header{ flex-direction:column; align-items:flex-start; gap:10px; }
  .header-actions{
    width:100%;
    gap:6px;
    flex-direction: column;
  }
  .header-actions .btn{
    width: 100%;
    justify-content: center;
  }
  .card{ padding: 10px; }
  .chart-card{ height: 250px; padding-bottom: 5vh; }
  .sticky-col{ min-width: 140px; font-size: 14px; }
  .btn{ padding: 6px 10px; font-size: 14px; }
  .summary-grid{ grid-template-columns: 1fr; gap: 10px; }
  .tabs-grid{ grid-template-columns: 1fr; }
  input, select{ font-size: 16px; } /* Prevent zoom on iOS */
  .modal-card{ width: 95vw; }
}

/* Small devices (landscape phones, 576px and up) */
@media (min-width: 576px) and (max-width: 767px){
  .chart-card{ height: 280px; }
  .sticky-col{ min-width: 160px; }
  .tabs-grid{ grid-template-columns: repeat(2, 1fr); }
}

/* Medium devices (tablets, 768px and up) */
@media (min-width: 768px) and (max-width: 1023px){
  .chart-card{ height: 300px; }
  .sticky-col{ min-width: 180px; }
  .tabs-grid{ grid-template-columns: repeat(2, 1fr); }
  .summary-grid{ grid-template-columns: repeat(2, 1fr); }
}

/* Large devices (desktops, 1024px and up) */
@media (min-width: 1024px){
  .chart-card{ height: 340px; }
  .tabs-grid{ grid-template-columns: repeat(4, 1fr); }
  .summary-grid{ grid-template-columns: repeat(3, 1fr); }
}

/* Extra large devices (large desktops, 1536px and up) */
@media (min-width: 1536px){
  .pre-sections{ max-width: 1280px; }
  .chart-card{ height: 380px; }
  .container{ max-width: 1400px; }
}

/* Touch device optimizations */
@media (hover: none) and (pointer: coarse) {
  .btn{ min-height: 44px; } /* Apple HIG minimum touch target */
  input, select{ min-height: 44px; }
  .calendar-day{ min-height: 80px; }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  :root{
    --border:#4a5f8f;
    --text:#ffffff;
  }
  .btn{ border-width: 2px; }
  input, select{ border-width: 2px; }
}

/* Dark mode system preference */
@media (prefers-color-scheme: dark) {
  :root:not(.light){
    /* Already using dark theme by default */
  }
}

/* Print styles */
@media print {
  body{ background: white; color: black; }
  .header-actions, .btn{ display: none !important; }
  .card{ box-shadow: none; border: 1px solid #ccc; }
  .chart-card{ page-break-inside: avoid; }
}

/* ===== Brighter, larger calendar icon for <input type="date"> ===== */

/* A crisp SVG we’ll use as an overlay icon (data URI so no extra file) */
:root{
  --cal-svg: url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e5e7eb' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>\
<rect x='3' y='4.5' width='18' height='16' rx='2.5' />\
<path d='M3 9h18' />\
<path d='M8 3v4M16 3v4' />\
<circle cx='8' cy='13' r='1'/><circle cx='12' cy='13' r='1'/><circle cx='16' cy='13' r='1'/>\
<circle cx='8' cy='17' r='1'/><circle cx='12' cy='17' r='1'/><circle cx='16' cy='17' r='1'/>\
</svg>");
}

/* Ensure the control renders with a dark color scheme so system icons stay visible */
input[type="date"]{
  color-scheme: dark;
  padding-right: 40px;                 /* room for the bigger icon */
  background-image: var(--cal-svg);    /* our high-contrast icon */
  background-repeat: no-repeat;
  background-position: right 10px center;
  background-size: 18px 18px;          /* tweak if you want it even bigger */
}

/* Hide the dim WebKit indicator so we don’t get two icons,
   but keep it clickable area intact (opacity works better than display:none) */
input[type="date"]::-webkit-calendar-picker-indicator{
  opacity: 0;                          /* visually hidden — click still opens picker */
}

/* Extra polish */
input[type="date"]::-webkit-clear-button,
input[type="date"]::-webkit-inner-spin-button{ display:none; }

/* If you prefer to KEEP the native icon and just brighten it, uncomment the
   rules below and use this instead (WebKit/Blink only): */

input[type="date"]::-webkit-calendar-picker-indicator{
  opacity: 1;
  filter: invert(1) brightness(1.8) contrast(1.2);  /* brighter on dark UI */
}

/* ===== End calendar icon tweaks ===== */
